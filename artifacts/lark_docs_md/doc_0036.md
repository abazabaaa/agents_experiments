https://lark-parser.readthedocs.io/en/stable/_downloads/2d7086e8ce7628b916237820c20847e4/tree_forest_transformer.ipynb

```
{
  "cells": [\
    {\
      "cell_type": "markdown",\
      "metadata": {},\
      "source": [\
        "\n# Transform a Forest\n\nThis example demonstrates how to subclass ``TreeForestTransformer`` to\ndirectly transform a SPPF.\n"\
      ]\
    },\
    {\
      "cell_type": "code",\
      "execution_count": null,\
      "metadata": {\
        "collapsed": false\
      },\
      "outputs": [],\
      "source": [\
        "from lark import Lark\nfrom lark.parsers.earley_forest import TreeForestTransformer, handles_ambiguity, Discard\n\nclass CustomTransformer(TreeForestTransformer):\n\n    @handles_ambiguity\n    def sentence(self, trees):\n        return next(tree for tree in trees if tree.data == 'simple')\n\n    def simple(self, children):\n        children.append('.')\n        return self.tree_class('simple', children)\n\n    def adj(self, children):\n        return Discard\n\n    def __default_token__(self, token):\n        return token.capitalize()\n\ngrammar = \"\"\"\n    sentence: noun verb noun        -> simple\n            | noun verb \"like\" noun -> comparative\n\n    noun: adj? NOUN\n    verb: VERB\n    adj: ADJ\n\n    NOUN: \"flies\" | \"bananas\" | \"fruit\"\n    VERB: \"like\" | \"flies\"\n    ADJ: \"fruit\"\n\n    %import common.WS\n    %ignore WS\n\"\"\"\n\nparser = Lark(grammar, start='sentence', ambiguity='forest')\nsentence = 'fruit flies like bananas'\nforest = parser.parse(sentence)\n\ntree = CustomTransformer(resolve_ambiguity=False).transform(forest)\nprint(tree.pretty())\n\n# Output:\n#\n# simple\n#   noun  Flies\n#   verb  Like\n#   noun  Bananas\n#   .\n#"\
      ]\
    }\
  ],
  "metadata": {
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.7.17"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
```