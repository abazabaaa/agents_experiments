https://lark-parser.readthedocs.io/en/stable/_downloads/08132b45db8ea39c7a8efd8acc048de2/create_ast.ipynb

```
{
  "cells": [\
    {\
      "cell_type": "markdown",\
      "metadata": {},\
      "source": [\
        "\n# Creating an AST from the parse tree\n\n    This example demonstrates how to transform a parse-tree into an AST using `lark.ast_utils`.\n\n    create_transformer() collects every subclass of `Ast` subclass from the module,\n    and creates a Lark transformer that builds the AST with no extra code.\n\n    This example only works with Python 3.\n"\
      ]\
    },\
    {\
      "cell_type": "code",\
      "execution_count": null,\
      "metadata": {\
        "collapsed": false\
      },\
      "outputs": [],\
      "source": [\
        "import sys\nfrom typing import List\nfrom dataclasses import dataclass\n\nfrom lark import Lark, ast_utils, Transformer, v_args\nfrom lark.tree import Meta\n\nthis_module = sys.modules[__name__]\n\n\n#\n#   Define AST\n#\nclass _Ast(ast_utils.Ast):\n    # This will be skipped by create_transformer(), because it starts with an underscore\n    pass\n\nclass _Statement(_Ast):\n    # This will be skipped by create_transformer(), because it starts with an underscore\n    pass\n\n@dataclass\nclass Value(_Ast, ast_utils.WithMeta):\n    \"Uses WithMeta to include line-number metadata in the meta attribute\"\n    meta: Meta\n    value: object\n\n@dataclass\nclass Name(_Ast):\n    name: str\n\n@dataclass\nclass CodeBlock(_Ast, ast_utils.AsList):\n    # Corresponds to code_block in the grammar\n    statements: List[_Statement]\n\n@dataclass\nclass If(_Statement):\n    cond: Value\n    then: CodeBlock\n\n@dataclass\nclass SetVar(_Statement):\n    # Corresponds to set_var in the grammar\n    name: str\n    value: Value\n\n@dataclass\nclass Print(_Statement):\n    value: Value\n\n\nclass ToAst(Transformer):\n    # Define extra transformation functions, for rules that don't correspond to an AST class.\n\n    def STRING(self, s):\n        # Remove quotation marks\n        return s[1:-1]\n\n    def DEC_NUMBER(self, n):\n        return int(n)\n\n    @v_args(inline=True)\n    def start(self, x):\n        return x\n\n#\n#   Define Parser\n#\n\nparser = Lark(\"\"\"\n    start: code_block\n\n    code_block: statement+\n\n    ?statement: if | set_var | print\n\n    if: \"if\" value \"{\" code_block \"}\"\n    set_var: NAME \"=\" value \";\"\n    print: \"print\" value \";\"\n\n    value: name | STRING | DEC_NUMBER\n    name: NAME\n\n    %import python (NAME, STRING, DEC_NUMBER)\n    %import common.WS\n    %ignore WS\n    \"\"\",\n    parser=\"lalr\",\n)\n\ntransformer = ast_utils.create_transformer(this_module, ToAst())\n\ndef parse(text):\n    tree = parser.parse(text)\n    return transformer.transform(tree)\n\n#\n#   Test\n#\n\nif __name__ == '__main__':\n    print(parse(\"\"\"\n        a = 1;\n        if a {\n            print \"a is 1\";\n            a = 2;\n        }\n    \"\"\"))"\
      ]\
    }\
  ],
  "metadata": {
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.7.17"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
```