https://lark-parser.readthedocs.io/en/stable/examples/turtle_dsl.html

- [Home](https://lark-parser.readthedocs.io/en/stable/index.html)
- [Examples for Lark](https://lark-parser.readthedocs.io/en/stable/examples/index.html)
- Turtle DSL
- [Edit on GitHub](https://github.com/lark-parser/lark/blob/acfe33d943a1310f3ca26145eb2896bc5c4955c9/docs/examples/turtle_dsl.rst)

[Previous](https://lark-parser.readthedocs.io/en/stable/examples/calc.html "Basic calculator") [Next](https://lark-parser.readthedocs.io/en/stable/examples/json_parser.html "Simple JSON Parser")

* * *

Note

[Go to the end](https://lark-parser.readthedocs.io/en/stable/examples/turtle_dsl.html#sphx-glr-download-examples-turtle-dsl-py)
to download the full example code

# Turtle DSL [](https://lark-parser.readthedocs.io/en/stable/examples/turtle_dsl.html\#turtle-dsl "Permalink to this heading")

Implements a LOGO-like toy language for Python’s turtle, with interpreter.

```
try:
    input = raw_input   # For Python2 compatibility
except NameError:
    pass

import turtle

from lark import Lark

turtle_grammar = """
    start: instruction+

    instruction: MOVEMENT NUMBER            -> movement
               | "c" COLOR [COLOR]          -> change_color
               | "fill" code_block          -> fill
               | "repeat" NUMBER code_block -> repeat

    code_block: "{" instruction+ "}"

    MOVEMENT: "f"|"b"|"l"|"r"
    COLOR: LETTER+

    %import common.LETTER
    %import common.INT -> NUMBER
    %import common.WS
    %ignore WS
"""

parser = Lark(turtle_grammar)

def run_instruction(t):
    if t.data == 'change_color':
        turtle.color(*t.children)   # We just pass the color names as-is

    elif t.data == 'movement':
        name, number = t.children
        { 'f': turtle.fd,
          'b': turtle.bk,
          'l': turtle.lt,
          'r': turtle.rt, }[name](int(number))

    elif t.data == 'repeat':
        count, block = t.children
        for i in range(int(count)):
            run_instruction(block)

    elif t.data == 'fill':
        turtle.begin_fill()
        run_instruction(t.children[0])
        turtle.end_fill()

    elif t.data == 'code_block':
        for cmd in t.children:
            run_instruction(cmd)
    else:
        raise SyntaxError('Unknown instruction: %s' % t.data)

def run_turtle(program):
    parse_tree = parser.parse(program)
    for inst in parse_tree.children:
        run_instruction(inst)

def main():
    while True:
        code = input('> ')
        try:
            run_turtle(code)
        except Exception as e:
            print(e)

def test():
    text = """
        c red yellow
        fill { repeat 36 {
            f200 l170
        }}
    """
    run_turtle(text)

if __name__ == '__main__':
    # test()
    main()

```

**Total running time of the script:** (0 minutes 0.000 seconds)

[`Download Python source code: turtle_dsl.py`](https://lark-parser.readthedocs.io/en/stable/_downloads/9cadc23f6b1e9e52f35d3cb0a28053b0/turtle_dsl.py)

[`Download Jupyter notebook: turtle_dsl.ipynb`](https://lark-parser.readthedocs.io/en/stable/_downloads/207f80f4ec59e1e363837373665f649f/turtle_dsl.ipynb)

[Gallery generated by Sphinx-Gallery](https://sphinx-gallery.github.io/)

Versions[latest](https://lark-parser.readthedocs.io/en/latest/examples/turtle_dsl.html)**[stable](https://lark-parser.readthedocs.io/en/stable/examples/turtle_dsl.html)**Downloads[PDF](https://lark-parser.readthedocs.io/_/downloads/en/stable/pdf/)[HTML](https://lark-parser.readthedocs.io/_/downloads/en/stable/htmlzip/)[EPUB](https://lark-parser.readthedocs.io/_/downloads/en/stable/epub/)On Read the Docs[Project Home](https://app.readthedocs.org/projects/lark-parser/?utm_source=lark-parser&utm_content=flyout)[Builds](https://app.readthedocs.org/projects/lark-parser/builds/?utm_source=lark-parser&utm_content=flyout)Search

* * *

[Addons documentation](https://docs.readthedocs.io/page/addons.html?utm_source=lark-parser&utm_content=flyout) ― Hosted by
[Read the Docs](https://about.readthedocs.com/?utm_source=lark-parser&utm_content=flyout)