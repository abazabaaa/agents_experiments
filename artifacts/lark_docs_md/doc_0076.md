https://lark-parser.readthedocs.io/en/stable/examples/advanced/tree_forest_transformer.html

- [Home](https://lark-parser.readthedocs.io/en/stable/index.html)
- [Examples for Lark](https://lark-parser.readthedocs.io/en/stable/examples/index.html)
- [Advanced Examples](https://lark-parser.readthedocs.io/en/stable/examples/advanced/index.html)
- Transform a Forest
- [Edit on GitHub](https://github.com/lark-parser/lark/blob/acfe33d943a1310f3ca26145eb2896bc5c4955c9/docs/examples/advanced/tree_forest_transformer.rst)

[Previous](https://lark-parser.readthedocs.io/en/stable/examples/advanced/custom_lexer.html "Custom lexer") [Next](https://lark-parser.readthedocs.io/en/stable/examples/advanced/_json_parser.html "Simple JSON Parser")

* * *

Note

[Go to the end](https://lark-parser.readthedocs.io/en/stable/examples/advanced/tree_forest_transformer.html#sphx-glr-download-examples-advanced-tree-forest-transformer-py)
to download the full example code

# Transform a Forest [](https://lark-parser.readthedocs.io/en/stable/examples/advanced/tree_forest_transformer.html\#transform-a-forest "Permalink to this heading")

This example demonstrates how to subclass `TreeForestTransformer` to
directly transform a SPPF.

```
from lark import Lark
from lark.parsers.earley_forest import TreeForestTransformer, handles_ambiguity, Discard

class CustomTransformer(TreeForestTransformer):

    @handles_ambiguity
    def sentence(self, trees):
        return next(tree for tree in trees if tree.data == 'simple')

    def simple(self, children):
        children.append('.')
        return self.tree_class('simple', children)

    def adj(self, children):
        return Discard

    def __default_token__(self, token):
        return token.capitalize()

grammar = """
    sentence: noun verb noun        -> simple
            | noun verb "like" noun -> comparative

    noun: adj? NOUN
    verb: VERB
    adj: ADJ

    NOUN: "flies" | "bananas" | "fruit"
    VERB: "like" | "flies"
    ADJ: "fruit"

    %import common.WS
    %ignore WS
"""

parser = Lark(grammar, start='sentence', ambiguity='forest')
sentence = 'fruit flies like bananas'
forest = parser.parse(sentence)

tree = CustomTransformer(resolve_ambiguity=False).transform(forest)
print(tree.pretty())

# Output:
#
# simple
#   noun  Flies
#   verb  Like
#   noun  Bananas
#   .
#

```

**Total running time of the script:** (0 minutes 0.000 seconds)

[`Download Python source code: tree_forest_transformer.py`](https://lark-parser.readthedocs.io/en/stable/_downloads/9d7d9d95319f4514ab7247f8eb86ddf0/tree_forest_transformer.py)

[`Download Jupyter notebook: tree_forest_transformer.ipynb`](https://lark-parser.readthedocs.io/en/stable/_downloads/2d7086e8ce7628b916237820c20847e4/tree_forest_transformer.ipynb)

[Gallery generated by Sphinx-Gallery](https://sphinx-gallery.github.io/)

Versions[latest](https://lark-parser.readthedocs.io/en/latest/examples/advanced/tree_forest_transformer.html)**[stable](https://lark-parser.readthedocs.io/en/stable/examples/advanced/tree_forest_transformer.html)**Downloads[PDF](https://lark-parser.readthedocs.io/_/downloads/en/stable/pdf/)[HTML](https://lark-parser.readthedocs.io/_/downloads/en/stable/htmlzip/)[EPUB](https://lark-parser.readthedocs.io/_/downloads/en/stable/epub/)On Read the Docs[Project Home](https://app.readthedocs.org/projects/lark-parser/?utm_source=lark-parser&utm_content=flyout)[Builds](https://app.readthedocs.org/projects/lark-parser/builds/?utm_source=lark-parser&utm_content=flyout)Search

* * *

[Addons documentation](https://docs.readthedocs.io/page/addons.html?utm_source=lark-parser&utm_content=flyout) ― Hosted by
[Read the Docs](https://about.readthedocs.com/?utm_source=lark-parser&utm_content=flyout)