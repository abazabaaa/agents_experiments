https://lark-parser.readthedocs.io/en/stable/_downloads/63680f346bf793a45964b4e687bde3d9/calc.ipynb

```
{
  "cells": [\
    {\
      "cell_type": "markdown",\
      "metadata": {},\
      "source": [\
        "\n# Basic calculator\n\nA simple example of a REPL calculator\n\nThis example shows how to write a basic calculator with variables.\n"\
      ]\
    },\
    {\
      "cell_type": "code",\
      "execution_count": null,\
      "metadata": {\
        "collapsed": false\
      },\
      "outputs": [],\
      "source": [\
        "from lark import Lark, Transformer, v_args\n\n\ntry:\n    input = raw_input   # For Python2 compatibility\nexcept NameError:\n    pass\n\n\ncalc_grammar = \"\"\"\n    ?start: sum\n          | NAME \"=\" sum    -> assign_var\n\n    ?sum: product\n        | sum \"+\" product   -> add\n        | sum \"-\" product   -> sub\n\n    ?product: atom\n        | product \"*\" atom  -> mul\n        | product \"/\" atom  -> div\n\n    ?atom: NUMBER           -> number\n         | \"-\" atom         -> neg\n         | NAME             -> var\n         | \"(\" sum \")\"\n\n    %import common.CNAME -> NAME\n    %import common.NUMBER\n    %import common.WS_INLINE\n\n    %ignore WS_INLINE\n\"\"\"\n\n\n@v_args(inline=True)    # Affects the signatures of the methods\nclass CalculateTree(Transformer):\n    from operator import add, sub, mul, truediv as div, neg\n    number = float\n\n    def __init__(self):\n        self.vars = {}\n\n    def assign_var(self, name, value):\n        self.vars[name] = value\n        return value\n\n    def var(self, name):\n        try:\n            return self.vars[name]\n        except KeyError:\n            raise Exception(\"Variable not found: %s\" % name)\n\n\ncalc_parser = Lark(calc_grammar, parser='lalr', transformer=CalculateTree())\ncalc = calc_parser.parse\n\n\ndef main():\n    while True:\n        try:\n            s = input('> ')\n        except EOFError:\n            break\n        print(calc(s))\n\n\ndef test():\n    print(calc(\"a = 1+2\"))\n    print(calc(\"1+a*-3\"))\n\n\nif __name__ == '__main__':\n    # test()\n    main()"\
      ]\
    }\
  ],
  "metadata": {
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.7.17"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
```